# HG changeset patch
# Parent 50d33cc018020d876df656079d550b21513179ff
# User aleth <aleth@instantbird.org>
Add splitter between video call area and the conv browser

diff --git a/im/content/conversation.xml b/im/content/conversation.xml
--- a/im/content/conversation.xml
+++ b/im/content/conversation.xml
@@ -34,20 +34,22 @@
                 </xul:hbox>
               </xul:vbox>
               <xul:vbox class="flexbox">
                 <xul:hbox class="flexbox">
                   <xul:box flex="1" class="flexbox"/>
                   <xul:button class="endCallButton" anonid="endCallButton"
                           command="cmd_endCall" tooltiptext="&endCall.label;"/>
                 </xul:hbox>
-                <xul:box flex="1" class="flexbox"/>
-                </xul:vbox>
+              </xul:vbox>
             </xul:stack>
-            <xul:notificationbox class="conv-messages" anonid="convNotificationBox" flex="1" xbl:inherits="chat">
+            <xul:splitter class="splitter" anonid="videoCall-splitter" hidden="true">
+              <xul:grippy/>
+            </xul:splitter>
+            <xul:notificationbox class="conv-messages" anonid="convNotificationBox" flex="2" xbl:inherits="chat">
               <xul:vbox flex="1">
                 <xul:browser anonid="browser" type="content-conversation" flex="1"
                              xbl:inherits="tooltip=contenttooltip,contextmenu=contentcontextmenu,autoscrollpopup"/>
                 <xul:progressmeter anonid="browserProgress" hidden="true"/>
                 <xul:findbar anonid="FindToolbar" reversed="true"/>
               </xul:vbox>
             </xul:notificationbox>
           </xul:vbox>
@@ -465,16 +467,17 @@
               pc.onicecandidate = event => {
                 if (event.candidate)
                   return;
                 pc.onicecandidate = null;
 
                 if (this._conv)
                   this._conv.acceptCall(pc.localDescription.sdp);
                 this.getElt("videoCallBox").removeAttribute("hidden");
+                this.getElt("videoCall-splitter").removeAttribute("hidden");
                 this.ongoingCall = true;
               };
             }, () => this.callError("Video"));
           }, () => this.callError("RemoteDesc"));
         ]]>
         </body>
       </method>
 
@@ -491,25 +494,27 @@
           delete this.callTimeout;
 
           let callWaitNotification = this.getElt("convNotificationBox");
           let notification =  callWaitNotification.getNotificationWithValue("video-call-wait");
           if (notification)
             callWaitNotification.removeNotification(notification);
 
           this.getElt("videoCallBox").removeAttribute("hidden");
+          this.getElt("videoCall-splitter").removeAttribute("hidden");
         ]]>
         </body>
       </method>
 
       <method name="endCall">
         <parameter name="aSender"/>
         <body>
         <![CDATA[
           this.getElt("videoCallBox").setAttribute("hidden", "true");
+          this.getElt("videoCall-splitter").setAttribute("hidden", "true");
 
           let remoteVideo = this.getElt("remoteVideo");
           if (remoteVideo) {
             remoteVideo.pause();
             if (remoteVideo.mozSrcObject)
               remoteVideo.mozSrcObject = null;
           }
 
diff --git a/im/themes/conversation.css b/im/themes/conversation.css
--- a/im/themes/conversation.css
+++ b/im/themes/conversation.css
@@ -435,17 +435,17 @@ grippy {
 .alltargets-item-icon {
   min-width: 16px;
   min-height: 16px;
 }
 
 /* Video call CSS */
 .videoCallBox {
   width: 100%;
-  min-height: 50%;
+  min-height: 144px; /* match .localVideo min-height */
   padding: 0;
 }
 
 .remoteVideo {
   width: 100%;
   height: 50%;
   background: black;
 }
